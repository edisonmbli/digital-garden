「光影代码」数字花园 - 系列教程章节规划
version：3.0

基于这份更完善的 PRD，我们对教程的章节进行了重构和扩展，使其更具结构性、更循序渐进。

### 序章：现代独立开发者的“第一性原理”
  - 0.1: 项目愿景：为何是“数字花园”？(介绍 PRD v2.1)
  - 0.2: 我们的“作战地图”：项目章节与学习路径概览。
  - 0.3: 告别单打独斗：AI 协同开发时代的“独立开发者”新定义。
  - 0.4: 我们的“AI 开发宪法”：project.rules 的重要性与核心内容展示 (附录形式)。


### 第一部分：奠基 (The Foundation) - 搭建一个全球化的骨架
目标: 搭建一个拥有专业级 CI/CD 流程、统一视觉风格、且具备国际化基础的“黄金骨架”。

#### 第一章：项目启动与“设计基因”注入

  - 实战: 初始化 Next.js 项目，连接 GitHub，并立即部署到 Vercel，打通自动化部署流程。
  - 教程: 讲解 Vercel 的 Git 工作流和预览部署的价值。
  - 实战: 定义“设计基因”（字体、颜色），并配置 globals.css 和 tailwind.config.ts。
  - 核心实战 : 定义完整的双主题“设计基因” (Dark Mode Theming)
  - 教程: 讲解如何通过 CSS 变量，为亮色和暗色模式分别定义一套完整的设计令牌 (Design Tokens)。
  - 实战: 在 globals.css 中，完整地为 :root 和 .dark 两个作用域，配置好我们 PRD 中定义的所有颜色和样式变量。
    (在本章，我们只完成主题的“数据”和“配置”层面。用于切换主题的 ThemeProvider 和 ThemeToggle 交互式组件，将移至后续构建网站主布局 (Header/Layout) 的章节中实现，以保证学习路径的平滑。)
  - 实战: 初始化 shadcn/ui，并验证一个按钮组件是否已自动应用新主题。

#### 第二章：内容与数据的“双核”驱动 (Sanity & Prisma)

  - 实战: 搭建本地 Docker Postgres 环境，初始化 Prisma，并创建 User, Like, Comment 的初始 Schema。
  - 实战: 初始化 Sanity 项目，创建 production 和 development 两个 Dataset。
  - 实战: 在 Sanity 中为 post 和 photo 等内容类型，添加多语言支持。
  - 教程: 讲解如何在 Sanity Schema 中实现内容的国际化。
  - 教程: 详细讲解如何在 Sanity 中使用 @sanity/document-internationalization 插件，来实现内容的“关联文档”式多语言管理。
  - 核心实战: 建立内容关联模型。在 Sanity 中创建 author schema，并在 log schema 中建立对 author 的引用关系。

#### 第三章：认证的“外包”艺术 (Clerk Deep Dive)
  目标: 将 Clerk 的认证能力无缝集成到我们的“数字花园”中，实现专业的路由保护、用户数据同步，并开启社交登录。

  - 3.1 核心理念：为什么选择“认证外包”？
    - 教程: 简要回顾独立开发者在认证上遇到的痛点（安全、耗时、复杂），并阐述为何使用 Clerk 这样的“认证专家”服务，是现代开发的最佳实践。
  - 3.2 项目集成与基础配置
    - 实战: 指导读者创建 Clerk 应用，获取 API Keys，并在 .env.local 和 Vercel 后台配置好环境变量。
    - 实战: 在根布局 app/[lang]/layout.tsx 中，使用 <ClerkProvider> 包裹整个应用，并讲解其作用。
  - 3.3 前端 UI 的“一键换肤”
    - 实战: 在网站的 Header 组件中，集成 Clerk 开箱即用的 <UserButton /> (用户已登录) 和 <SignInButton /> / <SignUpButton /> (用户未登录) 组件。
    - 教程: 演示如何通过 appearance 属性，让 Clerk 组件的视觉风格与我们第一章定义的“设计基因”完美融合。
  - 3.4 实现路由保护 (Middleware)
    - 实战: 创建 middleware.ts 文件，并配置一个基础版的 authMiddleware。
    - 实战: 在 publicRoutes 数组之外，创建一个受保护的路由（例如**/admin**），并验证未登录用户访问时，会被自动重定向到登录页。
  - 3.5 用户数据同步 (Webhook)
    - 核心实践: 这是本章最关键的后端逻辑。
    - 实战: 创建一个安全的 API Route (/api/webhooks/clerk)，用于接收 Clerk 在 user.created 事件时发送的 Webhook。
    - 实战: 编写 Webhook 处理函数，将接收到的 Clerk 用户数据（id, email_addresses, image_url 等），写入到我们用 Prisma 创建的 Postgres User 表中。
  - 3.6 开启社交登录 (GitHub)
    - 实战: 指导读者在 GitHub 创建 OAuth App，并将 Client ID 和 Secret 配置到 Clerk 后台。
    - 教程: 演示在完成了后台配置后，我们的登录模态框中会自动出现“使用 GitHub 登录”的选项，而前端代码几乎无需任何修改，以此展现 Clerk 的强大之处。

#### 第四章：构建全球化应用 (Internationalization, i18n)
  
  - 4.1 核心策略：为何选择“基于路径”的国际化？
    - 教程: 讲解 Path-based i18n (/en/..., /zh/...) 对 SEO 和用户体验的巨大优势，将其确立为我们的最佳实践。
  - 4.2 语言配置与“翻译词典”
    - 实战: 在项目根目录创建 i18n-config.ts，定义我们支持的语言列表 ['en', 'zh'] 和默认语言 en。
    - 实战: 创建 dictionaries 文件夹，并分别创建 en.json 和 zh.json，写入第一批 UI 文本（如 Header 中的导航链接文字）。
    - 实战: 创建 app/lib/dictionary.ts，编写一个 getDictionary 函数，用于在服务端安全地加载这些 JSON 文件。
  - 4.3 路由重构：拥抱 [lang] 动态段
    - 教程: 讲解为何需要将现有页面，迁移到 app/[lang]/ 这个新的目录结构下。
    - 实战: 将 app/page.tsx 和 app/layout.tsx，移动到新建的 app/[lang]/ 文件夹中。
    - 实战: 修改根布局 app/[lang]/layout.tsx 和首页 app/[lang]/page.tsx，使其能够接收并使用 params.lang 这个新的 props。
  - 4.4 中间件升级：融合“安保”与“迎宾”
    - 核心实践: 这是本章最关键的、也是最能体现架构思想的一步。
    - 教程: 讲解如何将 Clerk 的 authMiddleware 和我们的 i18n 语言检测逻辑，优雅地、无冲突地组合在一个 middleware.ts 文件中。
    - 实战: 升级 middleware.ts，加入 negotiator 和 @formatjs/intl-localematcher，实现对无前缀路径的自动语言重定向，同时保持对 /admin 等路由的保护。
  - 4.5 UI 实现：创建“语言切换器”
    - 实战: 创建一个可复用的客户端组件 LanguageSwitcher.tsx。
    - 教程: 讲解如何使用 usePathname 和 useRouter Hooks，来智能地生成切换到其他语言的链接，并实现语言切换。
    - 实战: 将这个 <LanguageSwitcher /> 组件，集成到我们第三章创建的 <Header /> 组件中。
  - 本章验收:
    ✅ 访问根路径 / 时，能根据浏览器语言，自动跳转到 /en 或 /zh。
    ✅ 网站 UI（如 Header 导航）能根据 URL 路径，正确显示中文或英文。
    ✅ 点击语言切换器，能够正确地在不同语言版本的页面之间跳转。
    ✅ /admin 等受保护的路由，在跳转后依然保持其保护状态。


### 第二部分：构建“数字花园” (Feature-Driven Implementation)
目标: 采用“特性驱动”的模式，将我们的“设计蓝图”和“后端能力”结合，一步步地将“光影代码”这个产品从概念变为现实。

#### 第五章: 构建网站的“视觉骨架”与核心体验
  - 教程: 讲解如何构建可复用的、贯穿全站的 Header 和 Footer 组件，并实现导航功能。
  - 核心实战:
    1. 实现核心交互组件: 在 Header 中，集成 Clerk 的 <UserButton> 和我们规划的“语言切换”、“主题切换”按钮，并实现“分组与分隔”的优雅布局。
    2. 创建核心页面的布局结构:
      - 首页 (/): 创建一个沉浸式的、以大幅图片或视频为主体的 Hero 组件，取代原有的“楼层”设计。
      - 关于我 (/about): 创建一个双栏布局的静态页面 AboutPageShell。
      - 影像馆 (/gallery): 创建 GalleryListPageShell，使用 Tailwind CSS Grid 实现响应式的网格基础布局。
      - 日志 (/log): 创建 LogPageShell，实现一个包含“介绍区”和“筛选/搜索区”的、功能更完善的列表页布局。

#### 第六章: 实现“只读”的沉浸式体验
  - 目标: 将后端数据注入到我们已经建好的页面骨架中，让网站“活”起来。
  - 实战:
  1. 创建 DAL (读操作): 编写所有数据读取函数（如 getPhotos, getPostBySlug）并用 React.cache 封装。
  2. 填充页面内容:
    - 在首页 Hero 组件中，获取并展示精选的摄影作品。
    - 在 /gallery 页面，获取并渲染“影像组”卡片列表。
    - 在 /log 页面，获取并渲染教程文章列表。

#### 第七章: 注入“生命感”：高级视觉与交互
  - 目标: 将我们的网站从“好看”提升到“惊艳”，实现 PRD 中定义的“流体与趣味性交互”。
  - 教程: 引入并讲解轻量级动画库 Framer Motion 的基础用法。
  - 核心实战:
    1. 添加微交互: 为 Header 的导航链接、卡片 hover 状态，添加细腻的过渡动画。
    2. 实现入场动画: 为页面的核心内容（如首页 Hero 区的文字、列表页的卡片），添加入场时的淡入/上浮效果。
    3. 构建动态布局: 在 /gallery/[group-slug] 详情页，我们将挑战一个砌体式/瀑布流 (Masonry) 布局，以实现错落有致的视觉效果。

#### 第八章: 实现用户交互与内容管理
  - 目标: 开启点赞、评论等社区功能，并打通 Sanity 的内容管理工作流。
  - 实战:
    1. 扩展 DAL (写操作) 并编写 Server Actions (likeAction, commentAction)。
    2. 构建 <LikeButton> 和 <CommentForm> 等客户端交互组件。
    3. 配置 Sanity Webhook 和 Next.js Draft Mode，实现实时内容预览 (Live Preview)。


### 第三部分：打磨与发布 (Polish & Launch)
目标: 完善用户体验细节，增加测试覆盖，并完成最终的生产部署。

#### 第九章：建立“质量护城河” (测试、授权与后台管理)
  - 实战: 使用 Playwright 为“用户登录并成功评论”的核心流程，录制并生成 E2E 测试。
  - 实战: 使用 Vitest 为 Server Action 编写单元测试。
  - 实战: (新) 在 Clerk 后台为自己分配 admin 角色，并使用 <Protect role="admin"> 构建一个简单的、用于管理评论的站内后台页面。
  - 教程: 讲解如何实现简单的、基于角色的访问控制 (RBAC)。

#### 第十章：按下发射按钮！ (生产环境部署与持续迭代)
  - 实战: 在 Vercel 后台，完成所有生产环境变量的最终配置。
  - 教程: 提供一份详细的“上线前检查清单 (Pre-launch Checklist)”。
  - 实战: 通过 PR 和预览部署，完成最后一轮审查，最终合并到 main 分支，正式上线！
